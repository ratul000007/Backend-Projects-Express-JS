<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Orders</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <h2>📦 Your Orders</h2>
  <div id="orders"></div>
  <p><a href="index.html">← Back to Products</a></p>

  <script type="module">
    import { request } from "./js/api.js";

    const token = localStorage.getItem("token");
    const ordersDiv = document.getElementById("orders");

    const loadOrders = async () => {
      try {
        const orders = await request("/orders", "GET", null, token);
        if (orders.length === 0) {
          ordersDiv.innerHTML = "<p>No orders yet.</p>";
          return;
        }

        ordersDiv.innerHTML = orders.map(order => `
          <div style="margin-bottom: 10px;">
            <b>Order #${order._id}</b><br/>
            ${order.items.map(i => `- ${i.quantity} x ${i.product.name}`).join("<br/>")}<br/>
            Total: $${order.totalPrice} — Status: ${order.status}
          </div>
        `).join("");
      } catch (err) {
        alert("Error loading orders: " + err.message);
      }
    };

    loadOrders();
  </script>
</body>
</html>
